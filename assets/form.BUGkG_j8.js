import{u as O}from"./dict.T-B4BfYS.js";import{d as y,r as v}from"./index.IjqvNGA0.js";import{p as Q,a as S,g as X}from"./relationships.C1GTxMUq.js";import{a as V,r as m,a0 as z,al as d,at as B,Q as b,o as f,R as a,S as E,u as r,X as o,b as G,F as J,ad as K,e as L,V as _,H as M,n as N}from"./vue.Bq5FSDyb.js";import"./dict.D9jRSx34.js";const P={class:"dialog-footer"},W=V({name:"RelationshipsDialog"}),Y=V({...W,emits:["refresh"],setup(Z,{expose:h,emit:D}){const T=D,g=m(),u=m(!1),i=m(!1),{relationship:k}=O("relationship"),l=z({relationId:"",personId:"",relatedId:"",relationType:"",marriageType:""}),w=m({personId:[{required:!0,message:"\u4EBA\u5458ID\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:v.number,trigger:"blur"}],relatedId:[{required:!0,message:"\u5173\u8054\u4EBA\u5458ID\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:v.number,trigger:"blur"}],relationType:[{required:!0,message:"\u5173\u7CFB\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),U=async()=>{if(!await g.value.validate().catch(()=>{}))return!1;try{i.value=!0,l.relationId?await Q(l):await S(l),y().success(l.relationId?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),u.value=!1,T("refresh")}catch(s){y().error(s.msg)}finally{i.value=!1}},R=s=>{i.value=!0,X({relationId:s}).then(e=>{Object.assign(l,e.data[0])}).finally(()=>{i.value=!1})};return h({openDialog:s=>{u.value=!0,l.relationId="",N(()=>{var e;(e=g.value)==null||e.resetFields()}),s&&(l.relationId=s,R(s))}}),(s,e)=>{const c=d("el-input"),n=d("el-form-item"),p=d("el-col"),q=d("el-option"),x=d("el-select"),F=d("el-row"),j=d("el-form"),I=d("el-button"),C=d("el-dialog"),H=B("loading");return f(),b(C,{title:r(l).relationId?"\u7F16\u8F91":"\u65B0\u589E",modelValue:r(u),"onUpdate:modelValue":e[5]||(e[5]=t=>M(u)?u.value=t:null),"close-on-click-modal":!1,draggable:""},{footer:a(()=>[L("span",P,[o(I,{onClick:e[4]||(e[4]=t=>u.value=!1)},{default:a(()=>e[6]||(e[6]=[_("\u53D6 \u6D88")])),_:1}),o(I,{type:"primary",onClick:U,disabled:r(i)},{default:a(()=>e[7]||(e[7]=[_("\u786E \u8BA4")])),_:1},8,["disabled"])])]),default:a(()=>[E((f(),b(j,{ref_key:"dataFormRef",ref:g,model:r(l),rules:r(w),formDialogRef:"","label-width":"90px"},{default:a(()=>[o(F,{gutter:24},{default:a(()=>[o(p,{span:12,class:"mb20"},{default:a(()=>[o(n,{label:"\u4EBA\u5458ID",prop:"personId"},{default:a(()=>[o(c,{modelValue:r(l).personId,"onUpdate:modelValue":e[0]||(e[0]=t=>r(l).personId=t),placeholder:"\u8BF7\u8F93\u5165\u4EBA\u5458ID"},null,8,["modelValue"])]),_:1})]),_:1}),o(p,{span:12,class:"mb20"},{default:a(()=>[o(n,{label:"\u5173\u8054\u4EBA\u5458ID",prop:"relatedId"},{default:a(()=>[o(c,{modelValue:r(l).relatedId,"onUpdate:modelValue":e[1]||(e[1]=t=>r(l).relatedId=t),placeholder:"\u8BF7\u8F93\u5165\u5173\u8054\u4EBA\u5458ID"},null,8,["modelValue"])]),_:1})]),_:1}),o(p,{span:12,class:"mb20"},{default:a(()=>[o(n,{label:"\u5173\u7CFB\u7C7B\u578B",prop:"relationType"},{default:a(()=>[o(x,{modelValue:r(l).relationType,"onUpdate:modelValue":e[2]||(e[2]=t=>r(l).relationType=t),placeholder:"\u8BF7\u9009\u62E9\u5173\u7CFB\u7C7B\u578B"},{default:a(()=>[(f(!0),G(J,null,K(r(k),(t,A)=>(f(),b(q,{value:t.value,label:t.label,key:A},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(p,{span:12,class:"mb20"},{default:a(()=>[o(n,{label:"\u5A5A\u59FB\u7C7B\u578B",prop:"marriageType"},{default:a(()=>[o(c,{modelValue:r(l).marriageType,"onUpdate:modelValue":e[3]||(e[3]=t=>r(l).marriageType=t),placeholder:"\u8BF7\u8F93\u5165\u5A5A\u59FB\u7C7B\u578B"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[H,r(i)]])]),_:1},8,["title","modelValue"])}}});export{Y as default};
