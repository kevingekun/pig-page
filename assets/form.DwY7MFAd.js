import{v as L,d as T,r as f}from"./index.C0rhdPVG.js";import{p as R,a as S,g as j,v as q}from"./fieldtype.BK5ZKu0b.js";import{a as v,r as n,a0 as C,al as m,at as H,Q as b,o as h,R as r,S as I,u as e,X as d,e as O,V,W as k,H as Q,n as W}from"./vue.Bq5FSDyb.js";const X={class:"dialog-footer"},z=v({name:"systemFieldTypeDialog"}),A=v({...z,emits:["refresh"],setup(E,{expose:_,emit:x}){const N=x,{t:i}=L.useI18n(),c=n(),u=n(!1),s=n(!1),l=C({id:"",columnType:"",attrType:"",packageName:"",createTime:""}),w=n({columnType:[{required:!0,message:"\u5B57\u6BB5\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:f.overLength,trigger:"blur"},{validator:(t,a,p)=>{q(t,a,p,l.id!=="")}}],attrType:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u5C5E\u6027\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],packageName:[{validator:f.overLength,trigger:"blur"}]}),B=async()=>{if(!await c.value.validate().catch(()=>{}))return!1;try{s.value=!0,l.id?await R(l):await S(l),T().success(i(l.id?"common.editSuccessText":"common.addSuccessText")),u.value=!1,N("refresh")}catch(t){T().error(t.msg)}finally{s.value=!1}},U=t=>{j(t).then(a=>{Object.assign(l,a.data)})};return _({openDialog:t=>{u.value=!0,W(()=>{var a;(a=c.value)==null||a.resetFields()}),t?(l.id=t,U(t)):l.id=""}}),(t,a)=>{const p=m("el-input"),g=m("el-form-item"),$=m("el-form"),y=m("el-button"),D=m("el-dialog"),F=H("loading");return h(),b(D,{title:e(l).id?t.$t("common.editBtn"):t.$t("common.addBtn"),modelValue:e(u),"onUpdate:modelValue":a[4]||(a[4]=o=>Q(u)?u.value=o:null),width:"600","close-on-click-modal":!1,draggable:""},{footer:r(()=>[O("span",X,[d(y,{onClick:a[3]||(a[3]=o=>u.value=!1)},{default:r(()=>[V(k(t.$t("common.cancelButtonText")),1)]),_:1}),d(y,{type:"primary",onClick:B,disabled:e(s)},{default:r(()=>[V(k(t.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:r(()=>[I((h(),b($,{ref_key:"dataFormRef",ref:c,model:e(l),rules:e(w),formDialogRef:"","label-width":"90px"},{default:r(()=>[d(g,{label:e(i)("fieldtype.columnType"),prop:"columnType"},{default:r(()=>[d(p,{modelValue:e(l).columnType,"onUpdate:modelValue":a[0]||(a[0]=o=>e(l).columnType=o),placeholder:e(i)("fieldtype.inputcolumnTypeTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(g,{label:e(i)("fieldtype.attrType"),prop:"attrType"},{default:r(()=>[d(p,{modelValue:e(l).attrType,"onUpdate:modelValue":a[1]||(a[1]=o=>e(l).attrType=o),placeholder:e(i)("fieldtype.inputattrTypeTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d(g,{label:e(i)("fieldtype.packageName"),prop:"packageName"},{default:r(()=>[d(p,{modelValue:e(l).packageName,"onUpdate:modelValue":a[2]||(a[2]=o=>e(l).packageName=o),placeholder:e(i)("fieldtype.inputpackageNameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[F,e(s)]])]),_:1},8,["title","modelValue"])}}});export{A as default};
