import{v as C,d as f,r as b}from"./index.VbW3VsEx.js";import{g as F,p as L,a as j,d as R}from"./dept.DVXOjYfD.js";import{a as v,r as p,a0 as H,al as n,at as Q,b as W,o as y,X as r,R as o,S as X,Q as z,u as t,e as A,V as I,W as V,H as E,n as G}from"./vue.Bq5FSDyb.js";const J={class:"system-dept-dialog-container"},K={class:"dialog-footer"},M=v({name:"systemDeptDialog"}),N=v({...M,emits:["refresh"],setup(P,{expose:$,emit:x}){const O=x,{t:_}=C.useI18n(),m=p(),l=H({parentId:"",deptId:"",name:"",sortOrder:9999}),c=p([]),u=p(!1),i=p(!1),T=p({parentId:[{required:!0,message:"\u4E0A\u7EA7\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{validator:b.overLength,trigger:"blur"},{required:!0,message:"\u90E8\u95E8\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],sortOrder:[{validator:b.overLength,trigger:"blur"},{required:!0,message:"\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),w=async()=>{if(!await m.value.validate().catch(()=>{}))return!1;try{i.value=!0,l.deptId?await L(l):await j(l),f().success(_(l.deptId?"common.editSuccessText":"common.addSuccessText")),u.value=!1,O("refresh")}catch(e){f().error(e.msg)}finally{i.value=!1}},k=async()=>{R().then(e=>{c.value=[];const a={id:"0",name:"\u6839\u90E8\u95E8",children:[]};a.children=e.data,c.value.push(a)})};return $({openDialog:(e,a)=>{u.value=!0,l.deptId="",G(()=>{var d;(d=m.value)==null||d.resetFields(),l.parentId=a}),e==="edit"&&F(a).then(d=>{Object.assign(l,d.data)}).catch(d=>{f().error(d.msg)}),k()}}),(e,a)=>{const d=n("el-tree-select"),g=n("el-form-item"),B=n("el-input"),D=n("el-input-number"),U=n("el-form"),h=n("el-button"),q=n("el-dialog"),S=Q("loading");return y(),W("div",J,[r(q,{title:t(l).deptId?e.$t("common.editBtn"):e.$t("common.addBtn"),modelValue:t(u),"onUpdate:modelValue":a[4]||(a[4]=s=>E(u)?u.value=s:null),width:"600"},{footer:o(()=>[A("span",K,[r(h,{onClick:a[3]||(a[3]=s=>u.value=!1)},{default:o(()=>[I(V(e.$t("common.cancelButtonText")),1)]),_:1}),r(h,{type:"primary",onClick:w,disabled:t(i)},{default:o(()=>[I(V(e.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:o(()=>[X((y(),z(U,{ref_key:"deptDialogFormRef",ref:m,model:t(l),"label-width":"90px",rules:t(T)},{default:o(()=>[r(g,{label:e.$t("sysdept.parentId"),prop:"parentId"},{default:o(()=>[r(d,{modelValue:t(l).parentId,"onUpdate:modelValue":a[0]||(a[0]=s=>t(l).parentId=s),data:t(c),props:{value:"id",label:"name",children:"children"},class:"w100",clearable:"","check-strictly":"","render-after-expand":!1,placeholder:e.$t("sysdept.inputparentIdTip")},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),r(g,{label:e.$t("sysdept.name"),prop:"name"},{default:o(()=>[r(B,{modelValue:t(l).name,"onUpdate:modelValue":a[1]||(a[1]=s=>t(l).name=s),placeholder:e.$t("sysdept.inputnameTip"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(g,{label:e.$t("sysdept.sortOrder"),prop:"sortOrder"},{default:o(()=>[r(D,{modelValue:t(l).sortOrder,"onUpdate:modelValue":a[2]||(a[2]=s=>t(l).sortOrder=s),placeholder:e.$t("sysdept.inputsortOrderTip"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[S,t(i)]])]),_:1},8,["title","modelValue"])])}}});export{N as default};
