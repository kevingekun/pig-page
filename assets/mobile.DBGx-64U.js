import{a as y,r as V,a0 as p,al as s,at as P,Q as f,o as b,R as l,X as a,u as o,e as w,S as I,V as R,W as K,ab as U}from"./vue.Bq5FSDyb.js";import{v as j,r as v,B as z,d as $,a as Q}from"./index.BYx-UbL6.js";const W=y({name:"loginMobile"}),X=y({...W,emits:["signInSuccess"],setup(A,{emit:k}){const{t:r}=j.useI18n(),S=k,m=V(),c=V(!1),i=p({mobile:"",code:""}),q=p({mobile:[{validator:v.overLength,trigger:"blur"},{required:!0,trigger:"blur",validator:v.validatePhone}],code:[{validator:v.overLength,trigger:"blur"},{required:!0,trigger:"blur",message:r("mobile.codeText")}]}),B=async()=>{if(!await m.value.validateField("mobile").catch(()=>{}))return;const t=await z(i.mobile);t.data?($().success("\u9A8C\u8BC1\u7801\u53D1\u9001\u6210\u529F"),C()):$().error(t.msg)},_=async()=>{if(await m.value.validate().catch(()=>{}))try{c.value=!0,await Q().loginByMobile(i),S("signInSuccess")}finally{c.value=!1}},e=p({msgText:r("mobile.codeText"),msgTime:60,msgKey:!1}),C=()=>{e.msgText=`${e.msgTime}\u79D2\u540E\u91CD\u53D1`,e.msgKey=!0;const t=setInterval(()=>{e.msgTime--,e.msgText=`${e.msgTime}\u79D2\u540E\u91CD\u53D1`,e.msgTime===0&&(e.msgTime=60,e.msgText=r("mobile.codeText"),e.msgKey=!1,clearInterval(t))},1e3)};return(t,n)=>{const x=s("el-input"),d=s("el-form-item"),F=s("ele-Position"),L=s("el-icon"),u=s("el-col"),T=s("el-button"),M=s("el-form"),h=P("waves");return b(),f(M,{size:"large",class:"login-content-form",ref_key:"loginFormRef",ref:m,rules:o(q),model:o(i),onKeyup:U(_,["enter"])},{default:l(()=>[a(d,{class:"login-animation1",prop:"mobile"},{default:l(()=>[a(x,{text:"",placeholder:t.$t("mobile.placeholder1"),modelValue:o(i).mobile,"onUpdate:modelValue":n[0]||(n[0]=g=>o(i).mobile=g),clearable:"",autocomplete:"off"},{prefix:l(()=>n[2]||(n[2]=[w("i",{class:"iconfont icon-dianhua el-input__icon"},null,-1)])),_:1},8,["placeholder","modelValue"])]),_:1}),a(d,{class:"login-animation2",prop:"code"},{default:l(()=>[a(u,{span:15},{default:l(()=>[a(x,{text:"",maxlength:"6",placeholder:t.$t("mobile.placeholder2"),modelValue:o(i).code,"onUpdate:modelValue":n[1]||(n[1]=g=>o(i).code=g),clearable:"",autocomplete:"off"},{prefix:l(()=>[a(L,{class:"el-input__icon"},{default:l(()=>[a(F)]),_:1})]),_:1},8,["placeholder","modelValue"])]),_:1}),a(u,{span:1}),a(u,{span:8},{default:l(()=>[I((b(),f(T,{class:"login-content-code",onClick:B,loading:o(e).msgKey},{default:l(()=>[R(K(o(e).msgText),1)]),_:1},8,["loading"])),[[h]])]),_:1})]),_:1}),a(d,{class:"login-animation3"},{default:l(()=>[I((b(),f(T,{type:"primary",class:"login-content-submit",onClick:_,loading:o(c)},{default:l(()=>[w("span",null,K(t.$t("mobile.btnText")),1)]),_:1},8,["loading"])),[[h]])]),_:1})]),_:1},8,["rules","model"])}}});export{X as default};
