import{s as x,a as S,E as N,_ as k}from"./index.Zpg3H9AI.js";import{g as _}from"./user.CmDmNkVN.js";import{p as U}from"./ibkr.CHOz6S_d.js";import{a as w,i as L,r as d,a0 as v,j as C,$ as D,n as g,al as u,Q as E,o as P,R,e as s,X as c,W as h,L as b,b as W,T as X}from"./vue.Bq5FSDyb.js";const A={style:{display:"flex","justify-content":"space-between"}},Q={style:{display:"flex"}},T={class:"info"},$={style:{"font-weight":"600",margin:"2px","font-size":"18px"}},q={style:{display:"flex","justify-content":"space-between","margin-top":"20px"}},B={style:{display:"flex"}},F={class:"info"},G={style:{display:"flex","justify-content":"space-between","margin-top":"20px"}},H={style:{display:"flex"}},J={class:"info"},K={href:"https://e9v8mnhoz1kgjkp.255032.xyz/",target:"_blank"},M={key:0,style:{display:"flex","justify-content":"space-between","margin-top":"20px"}},O={style:{display:"flex"}},Y={style:{display:"flex","justify-content":"space-between","margin-top":"20px"}},Z={style:{display:"flex"}},ee={style:{display:"flex","justify-content":"space-between","margin-top":"20px"}},se={style:{display:"flex"}},te=w({name:"currentUser"}),ae=k(w({...te,setup(ie){const{proxy:I}=L(),z=d(new Date),l=v({wxPushStatus:!0,iosPushStatus:!0,wxPushId:0,iosPushId:0}),n=v({connected:!0,authenticated:!1}),p=d({postName:"",name:"",username:"",userId:"",avatar:"",deptName:""}),y=d(!1);setInterval(()=>{z.value=new Date},1e3),C(()=>{const a=S().userInfos;V(a.user.userId),f(),j();const e=setInterval(f,1e4);D(()=>clearInterval(e))});const f=async()=>{try{let a=await U(null);a.code===0&&(n.connected=a.data.connected,n.authenticated=a.data.authenticated,await g())}catch{}},j=async()=>{try{let e=await(a=null,x({url:"/amin/sys-switch/listAll",method:"get",params:a}));e.code===0&&(e.data.forEach(t=>{t.switchName==="wxPush"&&(l.wxPushStatus=t.switchValue,l.wxPushId=t.id),t.switchName==="iosPush"&&(l.iosPushStatus=t.switchValue,l.iosPushId=t.id)}),await g())}catch{}var a},m=async(a,e)=>{let t={switchName:a,switchValue:e};var i;(await(i=t,x({url:"/amin/sys-switch/update",method:"post",data:i}))).code===0&&N.success("\u5F00\u5173\u66F4\u65B0\u6210\u529F")},V=async a=>{var e,t;try{y.value=!0;const i=await _(a);p.value=i.data,p.value.postName=((t=(e=i.data)==null?void 0:e.postList)==null?void 0:t.map(r=>r.postName).join(","))||"",p.value.avatar=I.baseURL+i.data.avatar}finally{y.value=!1}};return(a,e)=>{const t=u("el-avatar"),i=u("el-switch"),r=u("el-card");return P(),E(r,{style:{height:"100%"}},{default:R(()=>[s("div",A,[s("div",Q,[c(t,{style:{width:"30px",height:"30px"},shape:"circle",size:100,fit:"cover",src:"./assets/images/user.png"}),s("div",T,[s("span",$,h(p.value.name),1)])])]),s("div",q,[s("div",B,[c(t,{style:{width:"30px",height:"30px"},shape:"circle",size:100,fit:"cover",src:"./assets/images/connect.png"}),s("div",F,[s("span",{style:b([{color:n.connected?"green":"red"},{margin:"2px","font-weight":"600","font-size":"18px"}])}," ibkr "+h(n.connected?"\u5DF2\u8FDE\u63A5":"\u672A\u8FDE\u63A5"),5)])])]),s("div",G,[s("div",H,[c(t,{style:{width:"30px",height:"30px"},shape:"circle",size:100,fit:"cover",src:"./assets/images/auth.png"}),s("div",J,[s("span",{style:b([{color:n.authenticated?"green":"red"},{margin:"2px","font-weight":"600","font-size":"18px"}])}," ibkr "+h(n.authenticated?"\u5DF2\u8BA4\u8BC1":"\u672A\u8BA4\u8BC1"),5)])])]),s("a",K,[n.authenticated?X("",!0):(P(),W("div",M,[s("div",O,[c(t,{style:{width:"30px",height:"30px"},shape:"circle",size:100,fit:"cover",src:"./assets/images/go.png"}),e[4]||(e[4]=s("div",{class:"info"},[s("span",{style:{color:"green",margin:"2px","font-weight":"600","font-size":"18px"}},"\u53BB\u8BA4\u8BC1")],-1))])]))]),s("div",Y,[s("div",Z,[c(i,{modelValue:l.wxPushStatus,"onUpdate:modelValue":e[0]||(e[0]=o=>l.wxPushStatus=o),class:"ml-2","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"\u300C\u5FAE\u4FE1\u300D\u63A8\u9001\u5DF2\u5F00\u542F","inactive-text":"\u300C\u5FAE\u4FE1\u300D\u63A8\u9001\u5DF2\u5173\u95ED",onChange:e[1]||(e[1]=o=>m("wxPush",o))},null,8,["modelValue"])])]),s("div",ee,[s("div",se,[c(i,{modelValue:l.iosPushStatus,"onUpdate:modelValue":e[2]||(e[2]=o=>l.iosPushStatus=o),class:"ml-2","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"\u300Cios\u300D\u63A8\u9001\u5DF2\u5F00\u542F","inactive-text":"\u300Cios\u300D\u63A8\u9001\u5DF2\u5173\u95ED",onChange:e[3]||(e[3]=o=>m("iosPush",o))},null,8,["modelValue"])])])]),_:1})}}}),[["__scopeId","data-v-cc194966"]]);export{ae as default};
