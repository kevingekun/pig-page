import{d as b,r as I}from"./index.C6ZD86JL.js";import{p as C,a as H,g as O}from"./personFamily.BWbCTKcj.js";import{a as y,r as m,a0 as P,al as t,at as Q,Q as v,o as V,R as l,S,u as r,X as o,e as X,V as _,H as z,n as A}from"./vue.Bq5FSDyb.js";const B={class:"dialog-footer"},E=y({name:"PersonFamilyDialog"}),G=y({...E,emits:["refresh"],setup(J,{expose:h,emit:D}){const w=D,n=m(),u=m(!1),i=m(!1),a=P({id:"",personId:"",familyId:"",role:""}),k=m({personId:[{required:!0,message:"\u4EBA\u5458 ID\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:I.number,trigger:"blur"}],familyId:[{required:!0,message:"\u5BB6\u65CF ID\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:I.number,trigger:"blur"}]}),U=async()=>{if(!await n.value.validate().catch(()=>{}))return!1;try{i.value=!0,a.id?await C(a):await H(a),b().success(a.id?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),u.value=!1,w("refresh")}catch(d){b().error(d.msg)}finally{i.value=!1}},x=d=>{i.value=!0,O({id:d}).then(e=>{Object.assign(a,e.data[0])}).finally(()=>{i.value=!1})};return h({openDialog:d=>{u.value=!0,a.id="",A(()=>{var e;(e=n.value)==null||e.resetFields()}),d&&(a.id=d,x(d))}}),(d,e)=>{const f=t("el-input"),p=t("el-form-item"),c=t("el-col"),F=t("el-row"),R=t("el-form"),g=t("el-button"),j=t("el-dialog"),q=Q("loading");return V(),v(j,{title:r(a).id?"\u7F16\u8F91":"\u65B0\u589E",modelValue:r(u),"onUpdate:modelValue":e[4]||(e[4]=s=>z(u)?u.value=s:null),"close-on-click-modal":!1,draggable:""},{footer:l(()=>[X("span",B,[o(g,{onClick:e[3]||(e[3]=s=>u.value=!1)},{default:l(()=>e[5]||(e[5]=[_("\u53D6 \u6D88")])),_:1}),o(g,{type:"primary",onClick:U,disabled:r(i)},{default:l(()=>e[6]||(e[6]=[_("\u786E \u8BA4")])),_:1},8,["disabled"])])]),default:l(()=>[S((V(),v(R,{ref_key:"dataFormRef",ref:n,model:r(a),rules:r(k),formDialogRef:"","label-width":"90px"},{default:l(()=>[o(F,{gutter:24},{default:l(()=>[o(c,{span:12,class:"mb20"},{default:l(()=>[o(p,{label:"\u4EBA\u5458 ID",prop:"personId"},{default:l(()=>[o(f,{modelValue:r(a).personId,"onUpdate:modelValue":e[0]||(e[0]=s=>r(a).personId=s),placeholder:"\u8BF7\u8F93\u5165\u4EBA\u5458 ID"},null,8,["modelValue"])]),_:1})]),_:1}),o(c,{span:12,class:"mb20"},{default:l(()=>[o(p,{label:"\u5BB6\u65CF ID",prop:"familyId"},{default:l(()=>[o(f,{modelValue:r(a).familyId,"onUpdate:modelValue":e[1]||(e[1]=s=>r(a).familyId=s),placeholder:"\u8BF7\u8F93\u5165\u5BB6\u65CF ID"},null,8,["modelValue"])]),_:1})]),_:1}),o(c,{span:12,class:"mb20"},{default:l(()=>[o(p,{label:"\u5BB6\u65CF\u4E2D\u89D2\u8272",prop:"role"},{default:l(()=>[o(f,{modelValue:r(a).role,"onUpdate:modelValue":e[2]||(e[2]=s=>r(a).role=s),placeholder:"\u8BF7\u8F93\u5165\u5BB6\u65CF\u4E2D\u89D2\u8272"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[q,r(i)]])]),_:1},8,["title","modelValue"])}}});export{G as default};
