import{v as A,d as k,r as f}from"./index.-C1ni1oB.js";import{p as G,a as J,g as K}from"./datasource.DM8gP93S.js";import{u as M}from"./dict.DYaN2cg5.js";import{a as q,r as _,a0 as P,al as u,at as Y,Q as m,o as n,R as r,S as Z,u as e,X as s,T as b,b as U,F as x,ad as L,V,W as v,e as ee,H as ae,n as le}from"./vue.Bq5FSDyb.js";import"./dict.GOnh5BUf.js";const oe={class:"dialog-footer"},re=q({name:"systemDatasourceConfDialog"}),se=q({...re,emits:["refresh"],setup(te,{expose:N,emit:B}){const D=B,{t}=A.useI18n(),T=_(),g=_(!1),y=_(!1),{ds_config_type:R,ds_type:$}=M("ds_config_type","ds_type"),a=P({id:"",name:"",url:"",username:"",password:void 0,createTime:"",updateTime:"",dsType:"mysql",confType:0,dsName:"",instance:"",port:3306,host:""}),j=_({name:[{required:!0,message:"\u522B\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:f.overLength,trigger:"blur"},{validator:(d,l,h)=>{l&&!/(?=.*[a-z])(?=.*_)/.test(l)?h(new Error("\u6570\u636E\u6E90\u540D\u79F0\u4E0D\u5408\u6CD5, \u7EC4\u540D_\u6570\u636E\u6E90\u540D\u5F62\u5F0F")):h()},trigger:"blur"}],url:[{required:!0,message:"jdbcurl\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:10,max:500,message:"URL\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 10 \u548C 500 \u5B57\u7B26\u4E4B\u95F4",trigger:"blur"}],username:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dsType:[{required:!0,message:"\u6570\u636E\u5E93\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],confType:[{required:!0,message:"\u914D\u7F6E\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dsName:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u6570\u636E\u5E93\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],instance:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u5B9E\u4F8B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],port:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u7AEF\u53E3\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],host:[{validator:f.overLength,trigger:"blur"},{required:!0,message:"\u4E3B\u673A\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),C=async()=>{var d;if(!await T.value.validate().catch(()=>{}))return!1;a.password=(d=a.password)!=null&&d.includes("******")?void 0:a.password;try{y.value=!0,a.id?await G(a):await J(a),k().success(t(a.id?"common.editSuccessText":"common.addSuccessText")),g.value=!1,D("refresh")}catch(l){k().error(l.msg)}finally{y.value=!1}},F=d=>K(d).then(l=>{Object.assign(a,l.data)});return N({openDialog:async d=>{g.value=!0,a.id="",le(()=>{var l;(l=T.value)==null||l.resetFields()}),d&&(a.id=d,await F(d),a.password="********")}}),(d,l)=>{const h=u("el-option"),S=u("el-select"),p=u("el-form-item"),c=u("el-col"),i=u("el-input"),H=u("el-radio"),z=u("el-radio-group"),E=u("el-input-number"),I=u("el-row"),O=u("el-form"),w=u("el-button"),Q=u("el-dialog"),W=Y("loading");return n(),m(Q,{title:e(a).id?d.$t("common.editBtn"):d.$t("common.addBtn"),modelValue:e(g),"onUpdate:modelValue":l[11]||(l[11]=o=>ae(g)?g.value=o:null),"close-on-click-modal":!1,draggable:""},{footer:r(()=>[ee("span",oe,[s(w,{onClick:l[10]||(l[10]=o=>g.value=!1)},{default:r(()=>[V(v(d.$t("common.cancelButtonText")),1)]),_:1}),s(w,{type:"primary",onClick:C,disabled:e(y)},{default:r(()=>[V(v(d.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:r(()=>[Z((n(),m(O,{ref_key:"dataFormRef",ref:T,model:e(a),rules:e(j),formDialogRef:"","label-width":"90px"},{default:r(()=>[s(I,{gutter:20},{default:r(()=>[s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.dsType"),prop:"dsType"},{default:r(()=>[s(S,{modelValue:e(a).dsType,"onUpdate:modelValue":l[0]||(l[0]=o=>e(a).dsType=o),placeholder:e(t)("datasourceconf.inputdsTypeTip")},{default:r(()=>[(n(!0),U(x,null,L(e($),o=>(n(),m(h,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.name"),prop:"name"},{default:r(()=>[s(i,{modelValue:e(a).name,"onUpdate:modelValue":l[1]||(l[1]=o=>e(a).name=o),placeholder:e(t)("datasourceconf.inputnameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.username"),prop:"username"},{default:r(()=>[s(i,{modelValue:e(a).username,"onUpdate:modelValue":l[2]||(l[2]=o=>e(a).username=o),placeholder:e(t)("datasourceconf.inputusernameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.password"),prop:"password"},{default:r(()=>[s(i,{modelValue:e(a).password,"onUpdate:modelValue":l[3]||(l[3]=o=>e(a).password=o),placeholder:e(t)("datasourceconf.inputpasswordTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.confType"),prop:"confType"},{default:r(()=>[s(z,{modelValue:e(a).confType,"onUpdate:modelValue":l[4]||(l[4]=o=>e(a).confType=o)},{default:r(()=>[(n(!0),U(x,null,L(e(R),(o,X)=>(n(),m(H,{label:Number(o.value),border:"",key:X},{default:r(()=>[V(v(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(a).confType===0&&e(a).dsType==="mssql"?(n(),m(c,{key:0,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.instance"),prop:"instance"},{default:r(()=>[s(i,{modelValue:e(a).instance,"onUpdate:modelValue":l[5]||(l[5]=o=>e(a).instance=o),placeholder:e(t)("datasourceconf.inputinstanceTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===0?(n(),m(c,{key:1,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.port"),prop:"port"},{default:r(()=>[s(E,{modelValue:e(a).port,"onUpdate:modelValue":l[6]||(l[6]=o=>e(a).port=o),placeholder:e(t)("datasourceconf.inputportTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===0?(n(),m(c,{key:2,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.host"),prop:"host"},{default:r(()=>[s(i,{modelValue:e(a).host,"onUpdate:modelValue":l[7]||(l[7]=o=>e(a).host=o),placeholder:e(t)("datasourceconf.inputhostTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===0?(n(),m(c,{key:3,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.dsName"),prop:"dsName"},{default:r(()=>[s(i,{modelValue:e(a).dsName,"onUpdate:modelValue":l[8]||(l[8]=o=>e(a).dsName=o),placeholder:e(t)("datasourceconf.inputdsNameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===1?(n(),m(c,{key:4,span:24,class:"mb20"},{default:r(()=>[s(p,{label:e(t)("datasourceconf.url"),prop:"url"},{default:r(()=>[s(i,{modelValue:e(a).url,"onUpdate:modelValue":l[9]||(l[9]=o=>e(a).url=o),type:"textarea",placeholder:e(t)("datasourceconf.inputurlTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0)]),_:1})]),_:1},8,["model","rules"])),[[W,e(y)]])]),_:1},8,["title","modelValue"])}}});export{se as default};
