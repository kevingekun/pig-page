import{f as _,e as T}from"./role.KbZDLks6.js";import{v as V,p as j,o as P,d as A}from"./index.BZO6oVRg.js";import{a as p,r as n,a0 as E,al as r,at as H,b as M,o as N,X as t,R as i,S as R,u as l,e as u,V as k,W as y}from"./vue.Bq5FSDyb.js";const U={class:"system-role-dialog-container"},W={class:"flex items-center justify-between"},X={class:"flex mr-16"},q={class:"dialog-footer"},z=p({name:"role-permession"}),B=p({...z,setup(F,{expose:v}){const{t:D}=V.useI18n(),d=n(),b=n(!0),c=n(!1),e=E({checkedKeys:[],treeData:[],defaultProps:{label:"name",value:"id"},roleId:"",dialog:{isShowDialog:!1,title:"\u5206\u914D\u6743\u9650",submitTxt:"\u66F4\u65B0"}}),h=n([]),x=o=>{const a=e.treeData;for(let s=0;s<a.length;s++)d.value.store.nodesMap[a[s].id].expanded=o},w=o=>{var a,s;o?(a=d.value)==null||a.setCheckedKeys(e.treeData.map(g=>g.id)):(s=d.value)==null||s.setCheckedKeys([])},K=()=>{const o=d.value.getCheckedKeys().join(",").concat(",").concat(d.value.getHalfCheckedKeys().join(","));c.value=!0,T(e.roleId,o).then(()=>{e.dialog.isShowDialog=!1,A().success(D("common.editSuccessText"))}).finally(()=>{c.value=!1})};return v({openDialog:o=>{e.checkedKeys=[],e.treeData=[],h.value=[],e.roleId=o.roleId,c.value=!0,_(o.roleId).then(a=>(h.value=a.data,j())).then(a=>{e.treeData=a.data,e.checkedKeys=P.resolveAllEunuchNodeId(e.treeData,h.value,[])}).finally(()=>{c.value=!1}),e.dialog.isShowDialog=!0}}),(o,a)=>{const s=r("el-checkbox"),g=r("el-tree"),C=r("el-scrollbar"),f=r("el-button"),S=r("el-dialog"),I=H("loading");return N(),M("div",U,[t(S,{width:"30%",modelValue:l(e).dialog.isShowDialog,"onUpdate:modelValue":a[1]||(a[1]=m=>l(e).dialog.isShowDialog=m),"close-on-click-modal":!1,draggable:""},{header:i(()=>[u("div",W,[u("div",null,y(l(e).dialog.title),1),u("div",X,[t(s,{label:"\u5C55\u5F00/\u6298\u53E0",onChange:x}),t(s,{label:"\u5168\u9009/\u4E0D\u5168\u9009",onChange:w})])])]),footer:i(()=>[u("span",q,[t(f,{onClick:a[0]||(a[0]=m=>l(e).dialog.isShowDialog=!1)},{default:i(()=>a[2]||(a[2]=[k("\u53D6 \u6D88")])),_:1}),t(f,{type:"primary",onClick:K},{default:i(()=>[k(y(l(e).dialog.submitTxt),1)]),_:1})])]),default:i(()=>[t(C,{class:"h-[400px] sm:h-[600px]"},{default:i(()=>[R(t(g,{ref_key:"menuTree",ref:d,data:l(e).treeData,"default-checked-keys":l(e).checkedKeys,"check-strictly":!l(b),props:l(e).defaultProps,class:"filter-tree","node-key":"id","highlight-current":"","show-checkbox":""},null,8,["data","default-checked-keys","check-strictly","props"]),[[I,l(c)]])]),_:1})]),_:1},8,["modelValue"])])}}});export{B as default};
