const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index.9YuLV9UU.js","./sortable.esm.RxdiMRVV.js","./index.IjqvNGA0.js","./vue.Bq5FSDyb.js","./index.BG-hBW4t.css","./index.Ct7HIqnj.css","./add-dict.B0SDWnwk.js","./dict.D9jRSx34.js","./dict.T-B4BfYS.js"])))=>i.map(i=>d[i]);
import{c as j,__tla as al}from"./index.IjqvNGA0.js";import{a as ol,r as n,a0 as _,j as ul,n as tl,al as b,b as v,o as r,X as a,R as u,u as m,aD as B,H as P,F as f,ad as h,Q as w,a5 as dl}from"./vue.Bq5FSDyb.js";import{g as rl,h as ml,i as il}from"./table.bskmugpY.js";import{l as pl}from"./fieldtype.Z1jDCD7A.js";import{S as nl}from"./sortable.esm.RxdiMRVV.js";let H,bl=Promise.all([(()=>{try{return al}catch{}})()]).then(async()=>{H=ol({__name:"edit",props:{tableName:{type:String},dsName:{type:String}},setup(M,{expose:Q}){const x=B(()=>j(()=>import("./index.9YuLV9UU.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),X=B(()=>j(()=>import("./add-dict.B0SDWnwk.js"),__vite__mapDeps([6,2,3,4,7,8]),import.meta.url)),T=n(),N=n(""),S=M,G=n(!1),J=n(),q=n(),U=n([]),F=n([]),R=n(),k=n(),g=n(),i=n([]),K=_([{label:"DEFAULT",value:"DEFAULT"},{label:"INSERT",value:"INSERT"},{label:"UPDATE",value:"UPDATE"},{label:"INSERT_UPDATE",value:"INSERT_UPDATE"}]),W=_([{label:"=",value:"="},{label:"!=",value:"!="},{label:">",value:">"},{label:">=",value:">="},{label:"<",value:"<"},{label:"<=",value:"<="},{label:"like",value:"like"},{label:"left like",value:"left like"},{label:"right like",value:"right like"}]),z=_([{label:"\u5355\u884C\u6587\u672C",value:"text"},{label:"\u591A\u884C\u6587\u672C",value:"textarea"},{label:"\u6570\u5B57",value:"number"},{label:"\u5BCC\u6587\u672C\u7F16\u8F91\u5668",value:"editor"},{label:"\u4E0B\u62C9\u6846",value:"select"},{label:"\u5355\u9009\u6309\u94AE",value:"radio"},{label:"\u590D\u9009\u6846",value:"checkbox"},{label:"\u65E5\u671F",value:"date"},{label:"\u65E5\u671F\u65F6\u95F4",value:"datetime"},{label:"\u6587\u4EF6\u4E0A\u4F20",value:"upload-file"},{label:"\u56FE\u7247\u4E0A\u4F20",value:"upload-img"}]),Y=_([{label:"\u5355\u884C\u6587\u672C",value:"text"},{label:"\u591A\u884C\u6587\u672C",value:"textarea"},{label:"\u6570\u5B57",value:"number"},{label:"\u4E0B\u62C9\u6846",value:"select"},{label:"\u5355\u9009\u6309\u94AE",value:"radio"},{label:"\u590D\u9009\u6846",value:"checkbox"},{label:"\u65E5\u671F",value:"date"},{label:"\u65E5\u671F\u65F6\u95F4",value:"datetime"}]),Z=_([{label:"\u53BB\u91CD",value:"duplicate"},{label:"\u6570\u5B57",value:"number"},{label:"\u5B57\u6BCD",value:"letter"},{label:"\u5B57\u6BCD\u548C\u6570\u5B57",value:"letterAndNumber"},{label:"\u624B\u673A\u53F7\u7801",value:"mobilePhone"},{label:"\u5B57\u6BCD\u5F00\u5934\uFF0C\u4EC5\u53EF\u5305\u542B\u6570\u5B57",value:"letterStartNumberIncluded"},{label:"\u7981\u6B62\u4E2D\u6587\u8F93\u5165",value:"noChinese"},{label:"\u5FC5\u987B\u4E2D\u6587\u8F93\u5165",value:"chinese"},{label:"\u7535\u5B50\u90AE\u7BB1",value:"email"},{label:"URL\u7F51\u5740",value:"url"}]),D=_({tinyint:"number",smallint:"number",mediumint:"number",int:"number",integer:"number",bigint:"number",float:"number",datetime:"datetime",LocalDateTime:"datetime",date:"date",LocalDate:"date",Long:"number",Float:"number",Double:"number",BigDecimal:"number",text:"textarea",String:"text",longtext:"editor",bit:"radio",Boolean:"radio",char:"radio",varchar:"text"}),$=async d=>{await I(),R.value.fieldDict=d};ul(()=>{g.value=String(S.tableName),k.value=String(S.dsName),T.value="field",A(),L(k.value,g.value),O(),I()});const A=()=>{tl(()=>{const d=window.document.querySelector("#pane-field");J.value=nl.create(d,{handle:".drag-btn",onEnd:t=>{const{newIndex:p,oldIndex:o}=t,y=i.value.splice(o,1)[0];i.value.splice(p,0,y)}})})},C=n(!1),L=(d,t)=>{i.value=[],C.value=!0,rl(d,t).then(p=>{N.value=p.data.id,i.value=p.data.fieldList.map(o=>(o.queryFormType?o.queryFormType:D[o.fieldType],o.formType?o.formType:D[o.fieldType],o))}).finally(()=>{C.value=!1})},O=async()=>{U.value=[];const{data:d}=await pl(),t=new Map;d.forEach(p=>{const{attrType:o,columnType:y}=p;t.has(o)||(t.set(o,y),U.value.push({label:o,value:o}))}),U.value.push({label:"Object",value:"Object"})},I=()=>{ml().then(d=>{for(const t of d.data)F.value.push({label:t.description,value:t.dictType})})};return Q({openDialog:(d,t)=>{G.value=!0,g.value=t,k.value=d,T.value="field",A(),L(d,t),O(),I()},submitHandle:()=>new Promise(d=>{il(k.value,g.value,i.value).then(()=>{d(N.value)})})}),(d,t)=>{const p=b("el-checkbox"),o=b("el-table-column"),y=b("el-input"),s=b("el-option"),V=b("el-select"),ll=b("el-button"),E=b("el-tab-pane"),el=b("el-tabs");return r(),v(f,null,[a(el,{modelValue:m(T),"onUpdate:modelValue":t[3]||(t[3]=l=>P(T)?T.value=l:null)},{default:u(()=>[a(E,{label:"\u5C5E\u6027\u8BBE\u7F6E",name:"field"},{default:u(()=>[a(m(x),{ref:"fieldTable",modelValue:m(i),"onUpdate:modelValue":t[0]||(t[0]=l=>P(i)?i.value=l:null),hideAdd:!0,hideDelete:!0,"drag-sort":"",placeholder:"\u6682\u65E0\u6570\u636E"},{default:u(()=>[a(o,{label:"\u4E3B\u952E",prop:"primaryPk",width:"80","show-overflow-tooltip":""},{default:u(({row:l})=>[a(p,{modelValue:l.primaryPk,"onUpdate:modelValue":e=>l.primaryPk=e,"true-value":"1","false-value":"0",disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{label:"\u5B57\u6BB5\u540D",prop:"fieldName","show-overflow-tooltip":""}),a(o,{label:"\u8BF4\u660E",prop:"fieldComment","show-overflow-tooltip":""},{default:u(({row:l})=>[a(y,{modelValue:l.fieldComment,"onUpdate:modelValue":e=>l.fieldComment=e,placeholder:"\u8BF7\u8F93\u5165\u8BF4\u660E"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{label:"\u5B57\u6BB5\u7C7B\u578B",prop:"fieldType","show-overflow-tooltip":""}),a(o,{label:"\u5C5E\u6027\u540D",prop:"attrName","show-overflow-tooltip":""},{default:u(({row:l})=>[a(y,{modelValue:l.attrName,"onUpdate:modelValue":e=>l.attrName=e,placeholder:"\u8BF7\u8F93\u5165\u5C5E\u6027\u540D"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{label:"\u5C5E\u6027\u7C7B\u578B",prop:"attrType","show-overflow-tooltip":""},{default:u(({row:l})=>[a(V,{modelValue:l.attrType,"onUpdate:modelValue":e=>l.attrType=e,placeholder:"\u8BF7\u9009\u62E9\u5C5E\u6027\u7C7B\u578B",onChange:e=>(c=>{c.queryFormType=D[c.attrType],c.formType=D[c.attrType]})(l)},{default:u(()=>[(r(!0),v(f,null,h(m(U),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(o,{label:"\u81EA\u52A8\u586B\u5145",prop:"autoFill","show-overflow-tooltip":""},{default:u(({row:l})=>[a(V,{modelValue:l.autoFill,"onUpdate:modelValue":e=>l.autoFill=e,placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"},{default:u(()=>[(r(!0),v(f,null,h(m(K),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{label:"\u5B57\u5178\u540D\u79F0",prop:"fieldDict","show-overflow-tooltip":""},{default:u(({row:l})=>[a(V,{modelValue:l.fieldDict,"onUpdate:modelValue":e=>l.fieldDict=e,placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B",filterable:"",clearable:"",disabled:l.primaryPk==="1"},{prefix:u(()=>[a(ll,{icon:"Plus",type:"primary",link:"",onClick:dl(e=>(c=>{R.value=c,q.value.openDialog()})(l),["stop"])},null,8,["onClick"])]),default:u(()=>[(r(!0),v(f,null,h(m(F),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(E,{label:"\u5217\u8868\u67E5\u8BE2",name:"third"},{default:u(()=>[a(m(x),{ref:"gridTable",modelValue:m(i),"onUpdate:modelValue":t[1]||(t[1]=l=>P(i)?i.value=l:null),hideAdd:!0,hideDelete:!0,placeholder:"\u6682\u65E0\u6570\u636E"},{default:u(()=>[a(o,{label:"\u5C5E\u6027\u540D",prop:"attrName","show-overflow-tooltip":""}),a(o,{label:"\u8BF4\u660E",prop:"fieldComment","show-overflow-tooltip":""}),a(o,{label:"\u5217\u8868\u663E\u793A",prop:"gridItem",width:"100","show-overflow-tooltip":""},{default:u(({row:l})=>[a(p,{modelValue:l.gridItem,"onUpdate:modelValue":e=>l.gridItem=e,"true-value":"1","false-value":"0",disabled:l.primaryPk==="1"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u662F\u5426\u6392\u5E8F",prop:"gridSort",width:"100","show-overflow-tooltip":""},{default:u(({row:l})=>[a(p,{modelValue:l.gridSort,"onUpdate:modelValue":e=>l.gridSort=e,"true-value":"1","false-value":"0",disabled:l.primaryPk==="1"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u67E5\u8BE2\u663E\u793A",prop:"gridSort",width:"100","show-overflow-tooltip":""},{default:u(({row:l})=>[a(p,{modelValue:l.queryItem,"onUpdate:modelValue":e=>l.queryItem=e,"true-value":"1","false-value":"0",disabled:l.primaryPk==="1"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u67E5\u8BE2\u8868\u5355\u7C7B\u578B",prop:"queryFormType","show-overflow-tooltip":""},{default:u(({row:l})=>[a(V,{modelValue:l.queryFormType,"onUpdate:modelValue":e=>l.queryFormType=e,placeholder:"\u8BF7\u9009\u62E9\u67E5\u8BE2\u8868\u5355\u7C7B\u578B",disabled:l.primaryPk==="1"},{default:u(()=>[(r(!0),v(f,null,h(m(Y),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u67E5\u8BE2\u65B9\u5F0F",prop:"queryType","show-overflow-tooltip":""},{default:u(({row:l})=>[a(V,{modelValue:l.queryType,"onUpdate:modelValue":e=>l.queryType=e,placeholder:"\u8BF7\u9009\u62E9\u67E5\u8BE2\u65B9\u5F0F",disabled:l.primaryPk==="1"},{default:u(()=>[(r(!0),v(f,null,h(m(W),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(E,{label:"\u8868\u5355\u9875\u9762",name:"form"},{default:u(()=>[a(m(x),{ref:"formTable",modelValue:m(i),"onUpdate:modelValue":t[2]||(t[2]=l=>P(i)?i.value=l:null),hideAdd:!0,hideDelete:!0,placeholder:"\u6682\u65E0\u6570\u636E"},{default:u(()=>[a(o,{label:"\u5C5E\u6027\u540D",prop:"attrName","show-overflow-tooltip":""}),a(o,{label:"\u8BF4\u660E",prop:"fieldComment","show-overflow-tooltip":""}),a(o,{label:"\u8868\u5355\u7C7B\u578B",prop:"formType","show-overflow-tooltip":""},{default:u(({row:l})=>[a(V,{modelValue:l.formType,"onUpdate:modelValue":e=>l.formType=e,placeholder:"\u8BF7\u9009\u62E9\u8868\u5355\u7C7B\u578B",disabled:l.primaryPk==="1"},{default:u(()=>[(r(!0),v(f,null,h(m(z),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u662F\u5426\u663E\u793A",prop:"formItem",width:"100","show-overflow-tooltip":""},{default:u(({row:l})=>[a(p,{modelValue:l.formItem,"onUpdate:modelValue":e=>l.formItem=e,"true-value":"1","false-value":"0",disabled:l.primaryPk==="1"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u8868\u5355\u5FC5\u586B",prop:"formRequired",width:"100","show-overflow-tooltip":""},{default:u(({row:l})=>[a(p,{modelValue:l.formRequired,"onUpdate:modelValue":e=>l.formRequired=e,"true-value":"1","false-value":"0",disabled:l.primaryPk==="1"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u8868\u5355\u6548\u9A8C",prop:"formValidator","show-overflow-tooltip":""},{default:u(({row:l})=>[a(V,{modelValue:l.formValidator,"onUpdate:modelValue":e=>l.formValidator=e,placeholder:"\u8BF7\u9009\u62E9\u8868\u5355\u6548\u9A8C",disabled:l.primaryPk==="1"},{default:u(()=>[(r(!0),v(f,null,h(m(Z),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),a(m(X),{ref_key:"formDialogRef",ref:q,onRefresh:$},null,512)],64)}}})});export{bl as __tla,H as default};
