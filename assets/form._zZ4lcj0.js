import{v as R,d as V,r as S}from"./index.-C1ni1oB.js";import{p as q,a as C,g as j}from"./group.lxbl1ekj.js";import{l as E}from"./template.CIJ1HQHh.js";import{a as y,r as m,a0 as H,al as d,at as O,Q as b,o as c,R as r,S as Q,u as a,X as u,b as W,F as X,ad as z,e as A,V as x,W as D,H as J,n as K}from"./vue.Bq5FSDyb.js";const M={class:"dialog-footer"},P=y({name:"GenGroupDialog"}),Y=y({...P,emits:["refresh"],setup(Z,{expose:_,emit:I}){const N=I,{t:p}=R.useI18n(),g=m(),s=m(!1),i=m(!1),h=m([]),e=H({id:"",groupName:"",groupDesc:"",templateId:[],putList:[]}),T=m({groupName:[{validator:S.overLength,trigger:"blur"},{required:!0,message:"\u5206\u7EC4\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],templateId:[{required:!0,message:"\u6A21\u677F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),w=async()=>{if(!await g.value.validate().catch(()=>{}))return!1;try{i.value=!0,e.id?await q(e):await C(e),V().success(p(e.id?"common.editSuccessText":"common.addSuccessText")),s.value=!1,N("refresh")}catch(l){V().error(l.msg)}finally{i.value=!1}},$=l=>{j(l).then(t=>{Object.assign(e,t.data),e.templateId=[],t.data.templateList&&t.data.templateList.forEach(n=>{e.templateId.push(n.id)})})},k=()=>{E().then(l=>{h.value=l.data})};return _({openDialog:l=>{s.value=!0,e.id="",K(()=>{g.value.resetFields()}),l&&(e.id=l,$(l)),k()}}),(l,t)=>{const n=d("el-input"),f=d("el-form-item"),B=d("el-option"),G=d("el-select"),L=d("el-form"),v=d("el-button"),U=d("el-dialog"),F=O("loading");return c(),b(U,{modelValue:a(s),"onUpdate:modelValue":t[4]||(t[4]=o=>J(s)?s.value=o:null),title:a(e).id?l.$t("common.editBtn"):l.$t("common.addBtn"),width:"600"},{footer:r(()=>[A("span",M,[u(v,{onClick:t[3]||(t[3]=o=>s.value=!1)},{default:r(()=>[x(D(l.$t("common.cancelButtonText")),1)]),_:1}),u(v,{type:"primary",onClick:w,disabled:a(i)},{default:r(()=>[x(D(l.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:r(()=>[Q((c(),b(L,{ref_key:"dataFormRef",ref:g,model:a(e),rules:a(T),formDialogRef:"","label-width":"90px"},{default:r(()=>[u(f,{label:a(p)("group.groupName"),prop:"groupName"},{default:r(()=>[u(n,{modelValue:a(e).groupName,"onUpdate:modelValue":t[0]||(t[0]=o=>a(e).groupName=o),placeholder:a(p)("group.inputGroupNameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),u(f,{label:l.$t("group.templateType"),prop:"templateId"},{default:r(()=>[u(G,{modelValue:a(e).templateId,"onUpdate:modelValue":t[1]||(t[1]=o=>a(e).templateId=o),placeholder:l.$t("group.selectType"),clearable:"",multiple:""},{default:r(()=>[(c(!0),W(X,null,z(a(h),o=>(c(),b(B,{key:o.id,label:o.templateName,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(f,{label:a(p)("group.groupDesc"),prop:"groupDesc"},{default:r(()=>[u(n,{type:"textarea",maxlength:"100",rows:5,modelValue:a(e).groupDesc,"onUpdate:modelValue":t[2]||(t[2]=o=>a(e).groupDesc=o),placeholder:a(p)("group.inputGroupDescTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[F,a(i)]])]),_:1},8,["modelValue","title"])}}});export{Y as default};
