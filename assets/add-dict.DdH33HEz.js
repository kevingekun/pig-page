import{v as N,r as V,d as x}from"./index.VbW3VsEx.js";import{b as O,h as P,a as Q}from"./dict.CNZ7SPf3.js";import{u as W}from"./dict.rgtnKKMs.js";import{a as k,r as g,a0 as F,al as i,at as X,Q as T,o as y,R as d,S as A,u as a,X as t,b as G,F as J,ad as K,V as _,W as w,e as Y,H as Z,n as ee}from"./vue.Bq5FSDyb.js";const le={class:"dialog-footer"},ae=k({name:"systemDicDialog"}),te=k({...ae,emits:["refresh"],setup(oe,{expose:I,emit:U}){const C=U,{dict_type:D}=W("dict_type"),{t:c}=N.useI18n(),f=g(),s=g(!1),m=g(!1);g({});const o=F({id:"",dictType:"",description:"",systemFlag:"0",remarks:"",columns:[]}),q=F({dictType:[{validator:V.overLength,trigger:"blur"},{required:!0,message:"\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:V.validatorNameCn,trigger:"blur"},{validator:(l,r,h)=>{O(l,r,h,o.id!=="")},trigger:"blur"}],systemFlag:[{required:!0,message:"\u5B57\u5178\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],description:[{validator:V.overLength,trigger:"blur"},{required:!0,message:"\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],columns:[{required:!0,message:"\u5B57\u5178\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),L=async()=>{if(!await f.value.validate().catch(()=>{}))return!1;try{m.value=!0;const{data:l}=await P(o);o.columns.forEach(async r=>{r.dictId=l.id,r.dictType=o.dictType,await Q(r)}),x().success(c("common.addSuccessText")),s.value=!1,C("refresh",o.dictType)}catch(l){x().error(l.msg)}finally{m.value=!1}};let z=1;const B=()=>{o.columns.push({sortOrder:""+z++})};return I({openDialog:()=>{s.value=!0,o.id="",ee(()=>{var l;(l=f.value)==null||l.resetFields()})}}),(l,r)=>{const h=i("el-radio"),R=i("el-radio-group"),n=i("el-form-item"),p=i("el-input"),b=i("el-button"),v=i("el-table-column"),S=i("el-table"),E=i("el-col"),j=i("el-form"),H=i("el-dialog"),M=X("loading");return y(),T(H,{title:"\u65B0\u589E\u5B57\u5178",modelValue:a(s),"onUpdate:modelValue":r[4]||(r[4]=e=>Z(s)?s.value=e:null),width:"600"},{footer:d(()=>[Y("span",le,[t(b,{onClick:r[3]||(r[3]=e=>s.value=!1)},{default:d(()=>[_(w(l.$t("common.cancelButtonText")),1)]),_:1}),t(b,{onClick:L,type:"primary",disabled:a(m)},{default:d(()=>[_(w(l.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:d(()=>[A((y(),T(j,{model:a(o),rules:a(q),"label-width":"100px",ref_key:"dicDialogFormRef",ref:f},{default:d(()=>[t(n,{label:l.$t("sysdict.systemFlag"),prop:"systemFlag"},{default:d(()=>[t(R,{modelValue:a(o).systemFlag,"onUpdate:modelValue":r[0]||(r[0]=e=>a(o).systemFlag=e)},{default:d(()=>[(y(!0),G(J,null,K(a(D),(e,u)=>(y(),T(h,{border:"",key:u,label:e.value},{default:d(()=>[_(w(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(n,{label:l.$t("sysdict.dictType"),prop:"dictType"},{default:d(()=>[t(p,{placeholder:l.$t("sysdict.inputDictTypeTip"),disabled:a(o).id!=="",clearable:"",modelValue:a(o).dictType,"onUpdate:modelValue":r[1]||(r[1]=e=>a(o).dictType=e)},null,8,["placeholder","disabled","modelValue"])]),_:1},8,["label"]),t(n,{label:l.$t("sysdict.description"),prop:"description"},{default:d(()=>[t(p,{placeholder:l.$t("sysdict.inputDescriptionTip"),clearable:"",modelValue:a(o).description,"onUpdate:modelValue":r[2]||(r[2]=e=>a(o).description=e)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),t(E,{span:24,class:"mb20"},{default:d(()=>[t(n,{label:a(c)("dictItem.name"),prop:"columns"},{default:d(()=>[t(S,{data:a(o).columns,border:"",style:{width:"100%"},"max-height":"500"},{default:d(()=>[t(v,{type:"index",label:a(c)("createTable.index"),width:"50"},{header:d(()=>[t(b,{icon:"Plus",size:"small",type:"primary",circle:"",onClick:B})]),default:d(e=>[t(b,{icon:"Minus",size:"small",type:"danger",circle:"",onClick:u=>{return $=e.$index,e.row,void o.columns.splice($,1);var $}},null,8,["onClick"])]),_:1},8,["label"]),t(v,{prop:"label",label:l.$t("dictItem.label"),"show-overflow-tooltip":""},{default:d(e=>[t(p,{modelValue:e.row.label,"onUpdate:modelValue":u=>e.row.label=u,placeholder:a(c)("dictItem.inputLabelTip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"]),t(v,{prop:"value",label:l.$t("dictItem.itemValue"),"show-overflow-tooltip":""},{default:d(e=>[t(p,{modelValue:e.row.value,"onUpdate:modelValue":u=>e.row.value=u,placeholder:a(c)("dictItem.inputItemValueTip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model","rules"])),[[M,a(m)]])]),_:1},8,["modelValue"])}}});export{te as default};
