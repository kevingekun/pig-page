import{u as A}from"./table.BcOu3ffH.js";import{s as I,v as E,k as G,d as L}from"./index.C0rhdPVG.js";import{u as J}from"./dict.CECVM0WW.js";import{a as T,r as d,a0 as K,al as r,at as k,Q as c,o as p,R as i,e as D,X as l,S as m,u as e,V as w,W as j,H as V,O as P}from"./vue.Bq5FSDyb.js";import"./dict.YCb7JtL9.js";function Y(_){return I({url:"/job/sys-job-log/page",method:"get",params:_})}const Z={class:"layout-padding-auto layout-padding-view"},ee={class:"mb8",style:{width:"100%"}},le=T({name:"job-log"}),oe=T({...le,setup(_,{expose:$}){const{t}=E.useI18n(),g=d(!1),{job_execute_status:z}=J("job_type","job_execute_status"),B=d(),b=d(!0),v=d([]),x=d(!0),u=K({queryForm:{jobId:""},pageList:Y,createdIsNeed:!1}),{getDataList:h,currentChangeHandle:H,sizeChangeHandle:N,tableStyle:C}=A(u),Q=a=>{v.value=a.map(({jobLogId:o})=>o),x.value=!a.length},S=async a=>{try{await G().confirm(t("common.delConfirmText"))}catch{return}try{await function(o){return I({url:"/job/sys-job-log",method:"delete",data:o})}(a),h(),L().success(t("common.delSuccessText"))}catch(o){L().error(o.msg)}};return $({openDialog:a=>{g.value=!0,u.queryForm.jobId=a,h()}}),(a,o)=>{const y=r("el-button"),q=r("right-toolbar"),F=r("el-row"),n=r("el-table-column"),M=r("dict-tag"),R=r("el-table"),U=r("pagination"),O=r("el-dialog"),f=k("auth"),W=k("loading");return p(),c(O,{modelValue:e(g),"onUpdate:modelValue":o[2]||(o[2]=s=>V(g)?g.value=s:null),"close-on-click-modal":!1,fullscreen:"",title:"\u8FD0\u884C\u65E5\u5FD7",draggable:""},{default:i(()=>[D("div",Z,[l(F,null,{default:i(()=>[D("div",ee,[m((p(),c(y,{formDialogRef:"",disabled:e(x),icon:"Delete",type:"primary",class:"ml10",onClick:o[0]||(o[0]=s=>S(e(v)))},{default:i(()=>[w(j(a.$t("common.delBtn")),1)]),_:1},8,["disabled"])),[[f,"sys_log_del"]]),l(q,{showSearch:e(b),"onUpdate:showSearch":o[1]||(o[1]=s=>V(b)?b.value=s:null),class:"ml10",style:{float:"right","margin-right":"20px"},onQueryTable:e(h)},null,8,["showSearch","onQueryTable"])])]),_:1}),m((p(),c(R,{data:e(u).dataList,style:{width:"100%"},onSelectionChange:Q,border:"","cell-style":e(C).cellStyle,"header-cell-style":e(C).headerCellStyle},{default:i(()=>[l(n,{type:"selection",width:"40",align:"center"}),l(n,{type:"index",label:e(t)("log.index"),width:"80"},null,8,["label"]),l(n,{prop:"jobName",label:e(t)("log.jobName"),"show-overflow-tooltip":""},null,8,["label"]),l(n,{prop:"jobMessage",label:e(t)("log.jobMessage"),"show-overflow-tooltip":""},null,8,["label"]),l(n,{prop:"jobLogStatus",label:e(t)("log.jobLogStatus"),"show-overflow-tooltip":""},{default:i(s=>[l(M,{options:e(z),value:s.row.jobLogStatus},null,8,["options","value"])]),_:1},8,["label"]),l(n,{prop:"executeTime",label:e(t)("log.executeTime"),"show-overflow-tooltip":""},null,8,["label"]),l(n,{prop:"exceptionInfo",label:e(t)("log.exceptionInfo"),"show-overflow-tooltip":""},null,8,["label"]),l(n,{prop:"createTime",label:e(t)("log.createTime"),"show-overflow-tooltip":""},null,8,["label"]),l(n,{label:a.$t("common.action"),width:"150"},{default:i(s=>[m((p(),c(y,{text:"",type:"primary",onClick:X=>e(B).openDialog(s.row.jobLogId)},{default:i(()=>[w(j(a.$t("common.editBtn")),1)]),_:2},1032,["onClick"])),[[f,"pix_log_edit"]]),m((p(),c(y,{text:"",type:"primary",onClick:X=>S([s.row.jobLogId])},{default:i(()=>[w(j(a.$t("common.delBtn")),1)]),_:2},1032,["onClick"])),[[f,"sys_log_del"]])]),_:1},8,["label"])]),_:1},8,["data","cell-style","header-cell-style"])),[[W,e(u).loading]]),l(U,P({onSizeChange:e(N),onCurrentChange:e(H)},e(u).pagination),null,16,["onSizeChange","onCurrentChange"])])]),_:1},8,["modelValue"])}}});export{oe as default};
