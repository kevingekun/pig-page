import{u as P}from"./dict.Bb7Vwkz6.js";import{d as v}from"./index.Bmo3XfDz.js";import{p as Q,a as X,g as z}from"./persons.e1r6BUay.js";import{a as _,r as i,a0 as A,al as s,at as B,Q as b,o as f,R as t,S as E,u as r,X as l,b as G,F as J,ad as K,e as L,V as D,H as M,n as N}from"./vue.Bq5FSDyb.js";import"./dict.Dv_E0VZ8.js";const T={class:"dialog-footer"},W=_({name:"PersonsDialog"}),Y=_({...W,emits:["refresh"],setup(Z,{expose:y,emit:k}){const I=k,c=i(),u=i(!1),m=i(!1),{gender:U}=P("gender"),a=A({personId:"",name:"",gender:"",birthDate:"",deathDate:"",remarks:""}),w=i({name:[{required:!0,message:"\u59D3\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),x=async()=>{if(!await c.value.validate().catch(()=>{}))return!1;try{m.value=!0,a.personId?await Q(a):await X(a),v().success(a.personId?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),u.value=!1,I("refresh")}catch(d){v().error(d.msg)}finally{m.value=!1}},F=d=>{m.value=!0,z({personId:d}).then(e=>{Object.assign(a,e.data[0])}).finally(()=>{m.value=!1})};return y({openDialog:d=>{u.value=!0,a.personId="",N(()=>{var e;(e=c.value)==null||e.resetFields()}),d&&(a.personId=d,F(d))}}),(d,e)=>{const g=s("el-input"),n=s("el-form-item"),p=s("el-col"),R=s("el-option"),S=s("el-select"),h=s("el-date-picker"),j=s("el-row"),C=s("el-form"),V=s("el-button"),H=s("el-dialog"),q=B("loading");return f(),b(H,{title:r(a).personId?"\u7F16\u8F91":"\u65B0\u589E",modelValue:r(u),"onUpdate:modelValue":e[6]||(e[6]=o=>M(u)?u.value=o:null),"close-on-click-modal":!1,draggable:""},{footer:t(()=>[L("span",T,[l(V,{onClick:e[5]||(e[5]=o=>u.value=!1)},{default:t(()=>e[7]||(e[7]=[D("\u53D6 \u6D88")])),_:1}),l(V,{type:"primary",onClick:x,disabled:r(m)},{default:t(()=>e[8]||(e[8]=[D("\u786E \u8BA4")])),_:1},8,["disabled"])])]),default:t(()=>[E((f(),b(C,{ref_key:"dataFormRef",ref:c,model:r(a),rules:r(w),formDialogRef:"","label-width":"90px"},{default:t(()=>[l(j,{gutter:24},{default:t(()=>[l(p,{span:12,class:"mb20"},{default:t(()=>[l(n,{label:"\u59D3\u540D",prop:"name"},{default:t(()=>[l(g,{modelValue:r(a).name,"onUpdate:modelValue":e[0]||(e[0]=o=>r(a).name=o),placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D"},null,8,["modelValue"])]),_:1})]),_:1}),l(p,{span:12,class:"mb20"},{default:t(()=>[l(n,{label:"\u6027\u522B",prop:"gender"},{default:t(()=>[l(S,{modelValue:r(a).gender,"onUpdate:modelValue":e[1]||(e[1]=o=>r(a).gender=o),placeholder:"\u8BF7\u9009\u62E9\u6027\u522B"},{default:t(()=>[(f(!0),G(J,null,K(r(U),(o,O)=>(f(),b(R,{value:o.value,label:o.label,key:O},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(p,{span:12,class:"mb20"},{default:t(()=>[l(n,{label:"\u51FA\u751F\u65E5\u671F",prop:"birthDate"},{default:t(()=>[l(h,{type:"date",placeholder:"\u8BF7\u9009\u62E9\u51FA\u751F\u65E5\u671F",modelValue:r(a).birthDate,"onUpdate:modelValue":e[2]||(e[2]=o=>r(a).birthDate=o),"value-format":d.dateStr},null,8,["modelValue","value-format"])]),_:1})]),_:1}),l(p,{span:12,class:"mb20"},{default:t(()=>[l(n,{label:"\u53BB\u4E16\u65E5\u671F",prop:"deathDate"},{default:t(()=>[l(h,{type:"date",placeholder:"\u8BF7\u9009\u62E9\u53BB\u4E16\u65E5\u671F",modelValue:r(a).deathDate,"onUpdate:modelValue":e[3]||(e[3]=o=>r(a).deathDate=o),"value-format":d.dateStr},null,8,["modelValue","value-format"])]),_:1})]),_:1}),l(p,{span:12,class:"mb20"},{default:t(()=>[l(n,{label:"\u5907\u6CE8",prop:"remarks"},{default:t(()=>[l(g,{type:"textarea",modelValue:r(a).remarks,"onUpdate:modelValue":e[4]||(e[4]=o=>r(a).remarks=o),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[q,r(m)]])]),_:1},8,["title","modelValue"])}}});export{Y as default};
